<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<div>
    用户1：
</div>
<div>
    <div>

    </div>
    <div>
        <div>展示内容</div>
        <div class="show_conten"></div>
    </div>
</div>
<div>
    <input type="text" name="text_val" value="" class="val">
    <button class="btn">提交</button>
</div>
</body>
</html>
<script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript">

    var wsUrl = "ws://laravelim.net:9501";
    var websocket = new WebSocket(wsUrl);

    $(function () {
        $('.btn').click(function () {
            var val = $('.val').val();
            if(val.length < 1) {
                return false;
            }
            websocket.send(val);
            $('.val').val('');

        });
        // 实例对象 onopen
        websocket.onopen = function(evt) {
            console.log('contected-success');
        };

        // onmessage
        websocket.onmessage = function(evt) {
            console.log('return_data',evt);
            var data1 = evt.data;
            var data = $.parseJSON(data1);
            var html = '<p>用户'+ data.on +'：'+ data.msg +'</p>';
            $('.show_conten').append(html);
        };

        // onclose
        websocket.onclose = function(evt) {
            console.log('关闭');
        }

        // onerror
        websocket.onerror = function(evt) {
            console.log('error',evt);
        }
    })

</script>


<!-- <!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>WebSocket聊天室</title>
</head>
<body>
    聊天窗口：
    <div id="main" style="width:600px;height: 300px; overflow: auto;border: solid 2px black;">
    </div>
    <textarea id="textarea" placeholder="在这里输入信息"></textarea>
    <br />
    <input type="button" value="发送聊天" onclick="send()">
</body>
</html>

<script type="text/javascript">

var myDate = new Date();
var name = prompt("请输入您的昵称", "");
var main = document.getElementById("main");

var wsServer = 'ws://124.221.174.216:9501';

var websocket = new WebSocket(wsServer);

websocket.onopen = function (evt) {
    console.log("连接成功.");
};

websocket.onclose = function (evt) {
    console.log("连接已关闭...");
};

websocket.onmessage = function (evt) {

    var data = evt.data;

    console.log("收到 socket server 消息，内容：" + data);

    main.innerHTML += data + "<br />";
};

websocket.onerror = function (evt, e) {
    console.log('Error occured: ' + evt.data);
};

function send() {
    var data = document.getElementById("textarea").value;
    if (data === "") {
        alert("不能发送空信息");
        return false;
    }
    websocket.send(name + "：" + data);

    document.getElementById("textarea").value = "";
}
</script> -->